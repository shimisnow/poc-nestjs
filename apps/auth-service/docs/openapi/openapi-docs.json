{"openapi":"3.0.0","paths":{"/auth/login":{"post":{"operationId":"AuthController_login","parameters":[{"name":"X-Api-Version","in":"header","description":"Sets the API version","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginBodyDto"}}}},"responses":{"200":{"description":"JWT Access Token to use in future API calls","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginSerializer"}}}},"400":{"description":"Error validating request input data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginError400Serializer"}}}},"401":{"description":"User does not exists, exists and is inactive or the password is wrong","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError401Serializer"}}}},"500":{"description":"The server has encountered a situation it does not know how to handle. See server logs for details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError500Serializer"}}}},"502":{"description":"Internal data processing error. Probably a database error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError502Serializer"}}}}},"summary":"Uses username and password to get a JWT token to use in future API calls","tags":["auth"]}},"/auth/logout":{"post":{"operationId":"AuthController_logout","parameters":[{"name":"X-Api-Version","in":"header","description":"Sets the API version","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Information if the logout process was performed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutSerializer"}}}},"500":{"description":"The server has encountered a situation it does not know how to handle. See server logs for details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError500Serializer"}}}},"502":{"description":"Internal data processing error. Probably a database error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError502Serializer"}}}}},"security":[{"AccessToken":[]}],"summary":"Invalidates all tokens issued for a give login request","tags":["auth"]}},"/auth/refresh":{"get":{"operationId":"AuthController_refresh","parameters":[{"name":"X-Api-Version","in":"header","description":"Sets the API version","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"JWT Access Token to use in future API calls","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshSerializer"}}}},"401":{"description":"User does not exists or is inactive","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError401Serializer"}}}},"500":{"description":"The server has encountered a situation it does not know how to handle. See server logs for details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError500Serializer"}}}},"502":{"description":"Internal data processing error. Probably a database error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError502Serializer"}}}}},"security":[{"RefreshToken":[]}],"summary":"Uses refresh token to get new access token","tags":["auth"]}},"/auth/signup":{"post":{"operationId":"AuthController_signup","parameters":[{"name":"X-Api-Version","in":"header","description":"Sets the API version","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignUpBodyDto"}}}},"responses":{"200":{"description":"ID for the created user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignUpSerializer"}}}},"400":{"description":"Error validating request input data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignUpError400Serializer"}}}},"409":{"description":"User cannot be created. It already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignUpError409Serializer"}}}},"500":{"description":"The server has encountered a situation it does not know how to handle. See server logs for details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError500Serializer"}}}},"502":{"description":"Internal data processing error. Probably a database error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError502Serializer"}}}}},"summary":"Creates a new user","tags":["auth"]}},"/auth/password":{"post":{"operationId":"AuthController_passwordChange","parameters":[{"name":"X-Api-Version","in":"header","description":"Sets the API version","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordChangeBodyDto"}}}},"responses":{"200":{"description":"ID for the created user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordChangeSerializer"}}}},"400":{"description":"Error validating request input data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordChangeError400Serializer"}}}},"401":{"description":"User does not exists or is inactive or password is incorrect","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError401Serializer"}}}},"500":{"description":"The server has encountered a situation it does not know how to handle. See server logs for details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError500Serializer"}}}},"502":{"description":"Internal data processing error. Probably a database error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError502Serializer"}}}}},"security":[{"AccessToken":[]}],"summary":"Changes an user password","tags":["auth"]}},"/auth/verify":{"post":{"operationId":"AuthController_verifyTokenInvalidationProcess","parameters":[{"name":"X-Api-Version","in":"header","description":"Sets the API version","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyTokenInvalidationProcessBodyDto"}}}},"responses":{"200":{"description":"Information if the token is valid","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyTokenInvalidationProcessSerializer"}}}},"401":{"description":"User does not exists or is inactive or password is incorrect","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError401Serializer"}}}},"500":{"description":"The server has encountered a situation it does not know how to handle. See server logs for details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DefaultError500Serializer"}}}}},"summary":"Checkes if user has logged out or made a password change","tags":["auth"]}}},"info":{"title":"Auth Service","description":"","version":"1.0.0","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"AccessToken":{"scheme":"bearer","bearerFormat":"JWT","description":"accessToken provided by the login, refresh, or password endpoint","in":"header","type":"http"},"RefreshToken":{"scheme":"bearer","bearerFormat":"JWT","description":"refreshToken provided by the login, or password endpoint","in":"header","type":"http"}},"schemas":{"LoginBodyDto":{"type":"object","properties":{"username":{"type":"string","description":"Username","example":"anderson"},"password":{"type":"string","description":"User password in plain text","example":"te$st@12%34"},"requestRefreshToken":{"type":"boolean","description":"If the request should include a refreshToken","example":true,"default":false}},"required":["username","password","requestRefreshToken"]},"LoginSerializer":{"type":"object","properties":{"accessToken":{"type":"string","description":"Access token to be used at the private endpoints","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFuZGVyc29uIiwic3ViIjoxLCJpYXQiOjE2ODM4MzAyNTEsImV4cCI6MTY4MzgzMDMxMX0.eN5Cv2tJ0HGlVNKMtPv5VPeCIA7dd4OEA-8Heh7OJ_c"},"refreshToken":{"type":"string","description":"Refresh token to be used to get new access token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFuZGVyc29uIiwic3ViIjoxLCJpYXQiOjE2ODM4MzAyNTEsImV4cCI6MTY4MzgzMDMxMX0.eN5Cv2tJ0HGlVNKMtPv5VPeCIA7dd4OEA-8Heh7OJ_c"}},"required":["accessToken"]},"LoginError400Serializer":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP code","example":400},"message":{"description":"","example":["username should not be empty"],"type":"array","items":{"type":"string"}},"error":{"type":"string","description":"HTTP error message","example":"Bad Request"}},"required":["statusCode","message","error"]},"DefaultError401DataSerializer":{"type":"object","properties":{"name":{"type":"string","description":"Unique error name. Can be used to identify the error","enum":["EmptyJsonWebTokenError","JsonWebTokenError","JsonWebTokenPayloadStrutureError","TokenExpiredError","TokenInvalidatedByServer","UserPasswordError"]},"errors":{"description":"List with one or more error messages","example":["jwt expired","maxAge exceeded","invalid signature","exp must be a number conforming to the specified constraints","wrong user or password information"],"type":"array","items":{"type":"string"}},"expiredAt":{"format":"date-time","type":"string","description":"Available when the error is related to expired token","example":"2024-02-08T12:21:56.000Z"}},"required":["name"]},"DefaultError401Serializer":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP status code","example":401},"data":{"description":"Information about the error","allOf":[{"$ref":"#/components/schemas/DefaultError401DataSerializer"}]}},"required":["statusCode"]},"DefaultError500Serializer":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP code","example":500},"message":{"type":"string","description":"Additional error message","example":"Cannot set properties of undefined"},"error":{"type":"string","description":"HTTP error message","example":"Internal Server Error"}},"required":["statusCode","message","error"]},"DefaultError502Serializer":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP code","example":502},"error":{"type":"string","description":"HTTP error message","example":"Bad Gateway"}},"required":["statusCode","error"]},"LogoutSerializer":{"type":"object","properties":{"performed":{"type":"boolean","description":"Information if the logout process was performed","example":true},"performedAt":{"type":"number","description":"Number of milliseconds for this date since the epoch","example":1707755084516}},"required":["performed","performedAt"]},"RefreshSerializer":{"type":"object","properties":{"accessToken":{"type":"string","description":"Access token to be used at the private endpoints","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFuZGVyc29uIiwic3ViIjoxLCJpYXQiOjE2ODM4MzAyNTEsImV4cCI6MTY4MzgzMDMxMX0.eN5Cv2tJ0HGlVNKMtPv5VPeCIA7dd4OEA-8Heh7OJ_c"}},"required":["accessToken"]},"SignUpBodyDto":{"type":"object","properties":{"username":{"type":"string","description":"User name","example":"anderson"},"password":{"type":"string","description":"Password in plain text","example":"test@1234"}},"required":["username","password"]},"SignUpSerializer":{"type":"object","properties":{"userId":{"type":"string","description":"Generated user unique ID to be used at all services","example":"cf0accda-2ace-415b-8b02-5bd8bf267a9c"}}},"SignUpError400Serializer":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP code","example":400},"message":{"description":"","example":["username should not be empty"],"type":"array","items":{"type":"string"}},"error":{"type":"string","description":"HTTP error message","example":"Bad Request"}},"required":["statusCode","message","error"]},"SignUpError409Serializer":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP code","example":409},"error":{"type":"string","description":"HTTP error message","example":"Conflict"}},"required":["statusCode","error"]},"PasswordChangeBodyDto":{"type":"object","properties":{"currentPassword":{"type":"string","description":"Current password in plain text","example":"test@1234"},"newPassword":{"type":"string","description":"New password in plain text","example":"1234@test"},"requestRefreshToken":{"type":"boolean","description":"If the request should include a refreshToken","example":true,"default":false}},"required":["currentPassword","newPassword","requestRefreshToken"]},"PasswordChangeSerializer":{"type":"object","properties":{"performed":{"type":"boolean","description":"Information if the password change process was performed","example":true},"accessToken":{"type":"string","description":"Access token to be used at protected endpoints","example":"eyJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOiIxMGY4ODI1MS1kMTgxLTQyNTUtOTJlZC1kMGQ4NzRlM2ExNjYiLCJsb2dpbklkIjoiMTcwNzk0NzY1Mjg5OSIsImlhdCI6MTcwNzk0NzY1Mi44OTksImV4cCI6MTcwNzk0NzcxMi44OTl9.l5kCGNrX8CCYf5YkV0p7gw1SM6c9kFPQ64SL2mHCMpc"},"refreshToken":{"type":"string","description":"Refresh token to be used to get new access tokens","example":"eyJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOiI0Nzk5Y2MzMS03NjkyLTQwYjMtYWZmZi1jYzU2MmJhZjUzNzQiLCJsb2dpbklkIjoiMTcwNzk0NzY5MzE0OSIsImlhdCI6MTcwNzk0NzY5My4xNDksImV4cCI6MTcwNzk0Nzc1My4xNDl9.XDvAHGsDeqdmzz6P_5DMd7wFbsIooVAxfw44Jlpkc34"}},"required":["performed","accessToken","refreshToken"]},"PasswordChangeError400Serializer":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP code","example":400},"message":{"description":"","example":["currentPassword should not be empty"],"type":"array","items":{"type":"string"}},"error":{"type":"string","description":"HTTP error message","example":"Bad Request"}},"required":["statusCode","message","error"]},"VerifyTokenInvalidationProcessBodyDto":{"type":"object","properties":{"userId":{"type":"string","description":"User unique identification","example":"4799cc31-7692-40b3-afff-cc562baf5374"},"loginId":{"type":"string","description":"Login request identifiction","example":"1707920014294"},"iat":{"type":"number","description":"Token issued timestamp","example":1731506427},"verify":{"type":"array","description":"A list of additional verification to be performed","example":["isActive"],"items":{"type":"string","enum":["isActive"]}}},"required":["userId","loginId","iat"]},"VerifyTokenInvalidationProcessSerializer":{"type":"object","properties":{"valid":{"type":"boolean","description":"Information if is valid against the invalidation process","example":false},"invalidatedBy":{"type":"string","description":"Motive because the token is invalid","enum":["logout","password","user-status"],"example":"logout"}},"required":["valid","invalidatedBy"]}}}}